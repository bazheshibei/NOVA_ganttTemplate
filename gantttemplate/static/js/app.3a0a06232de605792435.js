webpackJsonp([1],{E0VY:function(e,t){},HXWd:function(e,t){},K61J:function(e,t){},"L//b":function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("7+uW"),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("keep-alive",[t("router-view")],1)],1)},staticRenderFns:[]};var s=a("VU/8")({name:"App"},n,!1,function(e){a("K61J")},null,null).exports,l=a("/ocq"),o=a("fZjL"),r=a.n(o),c=a("woOf"),_=a.n(c),d=a("Dd8w"),p=a.n(d),u=a("c1iM"),m=a("NYxO"),b={data:function(){return{lastShow:{ywlx:"",pp:"通用",pl:"通用",ssxz:"通用",ddlx:"通用"},lastVal:{ywlx:"",pp:"通用",pl:"通用",ssxz:"通用",ddlx:"通用"},selectShow:{ywlx:"",pp:"通用",pl:"通用",ssxz:"通用",ddlx:"通用"},selectVal:{ywlx:"",pp:"通用",pl:"通用",ssxz:"通用",ddlx:"通用"},min_lead_time:"",max_lead_time:"",templateName:""}},created:function(){this.$store.dispatch("A_getBusinessType",{that:this})},computed:p()({},Object(m.c)(["ywlx","pp","pl","ssxz","ddlx","templsteindex","pageType","p_type_id","nodeList"]),{plList:function(){var e=this.pl,t=this.selectVal.pp;if("通用"!==t){var a=[];return e.options.forEach(function(e){e.custom_id===t&&a.push(e)}),{label:"品类",index:"pl",options:a}}return{label:"品类",index:"pl",options:[]}}}),methods:{selectChange:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ywlx",a=this,i=this[t].options,n="通用",s="通用",l="",o=0;o<i.length;o++){var r=i[o],c=r.label,d=r.value,p=r.p_type_id;if(c===e){n=c,s=d,l=void 0===p?"":p;break}}var u=this.nodeList,m=this.selectVal[t],b=this.p_type_id,h="ywlx"===t&&b!==l&&""!==b,v="ywlx"!==t&&b&&m!==s,f="ywlx"===t&&m!==s,x=u.length;if((h||v||f)&&x)this.$confirm("切换后需重新添加节点, 是否确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){if("ywlx"===t&&a.$store.commit("saveData",{name:"p_type_id",obj:l}),a.$store.commit("saveData",{name:"nodeList",obj:[]}),a.$store.commit("saveData",{name:"tableObj",obj:{asd:[]}}),a.$store.commit("saveData",{name:"tableActive",obj:"asd"}),"ywlx"!==t?a.$refs[t][0].blur():a.$refs[t].blur(),a.selectVal[t]=s,a.lastVal[t]=s,a.lastShow[t]=n,"ywlx"===t&&a.$store.dispatch("A_getBusinessTypeData",{type_id:s,that:a}),"ywlx"===t){var e={pp:"通用",pl:"通用",ssxz:"通用",ddlx:"通用"};a.selectShow=_()({},a.selectShow,e),a.selectVal=_()({},a.selectVal,e),a.min_lead_time="",a.max_lead_time=""}else if("pp"===t){var i={pl:"通用",ssxz:"通用",ddlx:"通用"};a.selectShow=_()({},a.selectShow,i),a.selectVal=_()({},a.selectVal,i)}"ywlx"!==t&&a._saveData("select")}).catch(function(){"ywlx"!==t?a.$refs[t][0].blur():a.$refs[t].blur(),a.selectShow[t]=a.lastShow[t],a.selectVal[t]=a.lastVal[t]});else{if("ywlx"===t&&a.$store.commit("saveData",{name:"p_type_id",obj:l}),this.selectVal[t]=s,this.lastVal[t]=s,this.lastShow[t]=n,"ywlx"===t&&this.$store.dispatch("A_getBusinessTypeData",{type_id:s,that:this}),"ywlx"===t){var y={pp:"通用",pl:"通用",ssxz:"通用",ddlx:"通用"};this.selectShow=_()({},this.selectShow,y),this.selectVal=_()({},this.selectVal,y),this.min_lead_time="",this.max_lead_time=""}else if("pp"===t){var w={pl:"通用",ssxz:"通用",ddlx:"通用"};this.selectShow=_()({},this.selectShow,w),this.selectVal=_()({},this.selectVal,w)}"ywlx"!==t&&this._saveData("select")}},input:function(e,t){var a="-"===t[0]?"-":"";""===t||"-"===t||(isNaN(parseInt(t))?this[e]=a?"-1":1:this[e]=a?"-1":parseInt(t)),this._saveData("time")},blur:function(e,t){var a=t.target.value;""!==a&&"0"!==a||("-1"===this.min_lead_time&&"max_lead_time"===e?this[e]="1":this[e]="-1"),this._saveData("time")},_saveData:function(e){if("select"===e){var t=this.selectVal;this.$store.commit("saveData",{name:"selectVal",obj:t})}else if("time"===e){var a=this.min_lead_time,i=this.max_lead_time;this.$store.commit("saveData",{name:"min_lead_time",obj:a}),this.$store.commit("saveData",{name:"max_lead_time",obj:i})}u.a.templateName(this,e),this.$store.commit("saveData",{name:"template_name",obj:this.templateName})},_arrIncludes:function(e,t){for(var a=!1,i=0;i<t.length;i++)t[i]===e&&(a=!0);return a}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comBox"},["showView"!==e.pageType?a("div",{staticClass:"selectBox"},[a("div",{staticClass:"searchName"},[e._v(e._s(e.ywlx.label)+"：")]),e._v(" "),a("el-select",{ref:"ywlx",staticClass:"comSelect",attrs:{filterable:"","collapse-tags":"",placeholder:"请选择",size:"mini"},on:{change:e.selectChange},model:{value:e.selectShow.ywlx,callback:function(t){e.$set(e.selectShow,"ywlx",t)},expression:"selectShow.ywlx"}},e._l(e.ywlx.options,function(e,t){return a("el-option",{key:"options_"+t,staticClass:"comSelectOptions",attrs:{value:e.label}})}))],1):a("div",{staticClass:"selectBox textBox"},[e._v("\n    "+e._s(e.ywlx.label)+"："+e._s(e.selectShow.ywlx)+"\n  ")]),e._v(" "),e._l([e.pp,e.plList,e.ssxz,e.ddlx],function(t,i){return e._arrIncludes(t.index,e.templsteindex)&&"showView"!==e.pageType?a("div",{key:"select_"+i,staticClass:"selectBox"},[a("div",{staticClass:"searchName"},[e._v(e._s(t.label)+"：")]),e._v(" "),a("el-select",{ref:t.index,refInFor:!0,staticClass:"comSelect",attrs:{filterable:"","collapse-tags":"",placeholder:"请选择",size:"mini"},on:{change:function(a){e.selectChange(a,t.index)}},model:{value:e.selectShow[t.index],callback:function(a){e.$set(e.selectShow,t.index,a)},expression:"selectShow[item.index]"}},[a("el-option",{staticClass:"comSelectOptions",attrs:{value:"通用"}}),e._v(" "),e._l(t.options,function(e,t){return a("el-option",{key:"options_"+t,staticClass:"comSelectOptions",attrs:{value:e.label}})})],2)],1):e._e()}),e._v(" "),e._l([e.pp,e.plList,e.ssxz,e.ddlx],function(t,i){return e._arrIncludes(t.index,e.templsteindex)&&"showView"===e.pageType?a("div",{key:"select_"+i,staticClass:"selectBox textBox"},[e._v("\n    "+e._s(t.label)+"："+e._s(e.selectShow[t.index]||"通用")+"\n  ")]):e._e()}),e._v(" "),e._arrIncludes("jhzq",e.templsteindex)&&"showView"!==e.pageType?a("div",{staticClass:"selectBox"},[a("div",{staticClass:"searchName"},[e._v("交货周期：")]),e._v(" "),a("el-input",{attrs:{size:"mini",placeholder:"最小天数"},on:{input:function(t){e.input("min_lead_time",t)},blur:function(t){e.blur("min_lead_time",t)}},model:{value:e.min_lead_time,callback:function(t){e.min_lead_time=t},expression:"min_lead_time"}}),e._v(" "),a("span",[e._v("  至  ")]),e._v(" "),a("el-input",{attrs:{size:"mini",placeholder:"最大天数"},on:{input:function(t){e.input("max_lead_time",t)},blur:function(t){e.blur("max_lead_time",t)}},model:{value:e.max_lead_time,callback:function(t){e.max_lead_time=t},expression:"max_lead_time"}})],1):e._e(),e._v(" "),e._arrIncludes("jhzq",e.templsteindex)&&"showView"===e.pageType?a("div",{staticClass:"selectBox textBox"},[e._v("\n    交货周期："+e._s(e.min_lead_time||0)+"天"),a("span",[e._v(" 至 ")]),e._v(e._s(e.max_lead_time||0)+"天\n  ")]):e._e(),e._v(" "),"showView"!==e.pageType?a("div",{staticClass:"templateBox"},[a("div",{staticClass:"templateName"},[e._v("模板名称：")]),e._v(" "),a("el-input",{attrs:{size:"mini",placeholder:"请选择业务类型"},on:{change:function(t){e._saveData("")}},model:{value:e.templateName,callback:function(t){e.templateName=t},expression:"templateName"}})],1):a("div",{staticClass:"templateBox textBox"},[e._v("\n    模板名称："+e._s(e.templateName)+"\n  ")])],2)},staticRenderFns:[]};var v=a("VU/8")(b,h,!1,function(e){a("t6hP"),a("jZ2/")},"data-v-bc38f6b8",null).exports,f={data:function(){return{startObj:{KHXDRQ:"客户下单日期",KSTXDSJ:"款式图下单时间",YHRQ:"验货日期",FPJCRQ:"发票寄出日期"},endObj:{KHJQ:"客户交期",GCJQ:"工厂交期"}}},computed:p()({},Object(m.c)(["nodeList","pageType","selectVal","p_type_id","min_lead_time","max_lead_time"])),methods:{add:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.pageType,a=this.selectVal.ywlx;if(a){var i=this;if(e){var n=window.location.origin+"/nova/",s=this.selectVal,l=s.pp,o=s.pl,r=s.ssxz,c=s.ddlx,d=this.min_lead_time,p=this.max_lead_time,u=i.p_type_id,m="";if(u){var b={p_type_id:u,custom_id:l,dress_type_id:o,business_group_id:r,order_type:c,min_lead_time:d,max_lead_time:p},h=[];for(var v in b)"通用"===b[v]?h.push(v+"="):h.push(v+"="+b[v]);m=h.join("&")}win({url:n+"pages/nodeinfo/nodeInfolist.jsp?htmlchoice=true&node_business_type_id="+a+"&"+m,param:{},width:1100,height:550,title:"批量添加节点",onClose:function(){var e=i.nodeList,t=JSON.parse(localStorage.getItem("ganttTemplateChoiceNodeData"))||[],a={};e.forEach(function(e){a[e.node_id]=e});var n=e.length,s=[];t.forEach(function(e){if(!a[e.node_id]){var t={},i={key:n,badge:[],submit_type:1,sys_clac_formula:"",min_section_value:"",max_section_value:"",verification_remark:""};2===e.node_ierarchy&&(t.submit_type=2),s.push(_()({},e,i,t)),n++}}),i.$store.commit("saveData",{name:"addNode",obj:!0}),i.$store.commit("pushData",{name:"nodeList",obj:s}),localStorage.removeItem("ganttTemplateChoiceNodeData")}})}else{var f=i.nodeList,x=i.$store.state.templateData.ganttTemplateDetail||[],y={};f.forEach(function(e){y[e.node_id]=e});var w=f.length,g=[];x.forEach(function(e){if(!y[e.node_id]){var t={},a={key:w,badge:[],submit_type:1,sys_clac_formula:"",min_section_value:"",max_section_value:"",verification_remark:""};2===e.node_ierarchy&&(t.submit_type=2),g.push(_()({},a,e,t)),w++}}),i.$store.commit("saveData",{name:"addNode",obj:!0}),i.$store.commit("pushData",{name:"nodeList",obj:g})}}else a||""!==t||this.$message.error("请先选择业务类型")}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comBox"},[a("div",{staticClass:"selectBox"},[a("div",{staticClass:"searchName"},[e._v("设置节点   ")]),e._v(" "),a("div",{staticClass:"searchVal"},[a("el-button",{attrs:{type:"primary",size:"mini",plain:"",disabled:"showView"===e.pageType},on:{click:e.add}},[e._v("批量添加节点")])],1)]),e._v(" "),e._l(e.startObj,function(t,i){return a("div",{key:"start_"+i,staticClass:"selectBox textBox blue"},[a("div",{staticClass:"searchName"},[e._v(e._s(t)+"：")]),e._v(" "),a("span",[e._v(e._s(i))])])}),e._v(" "),e._l(e.endObj,function(t,i){return a("div",{key:"end_"+i,staticClass:"selectBox textBox red"},[a("div",{staticClass:"searchName"},[e._v(e._s(t)+"：")]),e._v(" "),a("span",[e._v(e._s(i))])])})],2)},staticRenderFns:[]};var y=a("VU/8")(f,x,!1,function(e){a("L//b"),a("E0VY")},"data-v-435c6028",null).exports,w=a("mvHQ"),g=a.n(w),j=a("d7EF"),O=a.n(j),C=a("bOdI"),T=a.n(C),S={created:function(){this._countHeight()},data:function(){return{tableHeight:0,ierarchyObj:{1:"提报节点",2:"内控节点"},typeObj:{1:"系统计算",2:"用户提报",3:"系统生成"},codeObj:{},inputCode:{},inputStatus:{}}},watch:{"$store.state.isCountTableHeight":function(){var e=this;this.$store.state.isCountTableHeight&&setTimeout(function(){e._countHeight()},1)}},computed:p()({},Object(m.c)(["nodeList","tableObj","tableActive","pageType"]),Object(m.b)(["tableData"]),{arrCode:function(){var e={KHXDRQ:!0,KSTXDSJ:!0,YHRQ:!0,FPJCRQ:!0,KHJQ:!0,GCJQ:!0};return this.tableData.forEach(function(t){e[t.node_code]=!0}),e},arrCodeUsed:function(){return r()(this.codeObj)}}),methods:{inputChange:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=this.inputStatus,s=!0;if(t){if(u.a.windowOpen(t)){var l=u.a.includes(e,t,this),o="main"!==i||u.a.useSelf(e,t,a,this),r="main"!==i||u.a.eachOther(e,t,a,this),c=u.a.math(e,t,this);s=l&&o&&r&&c}else this.$alert("闲的蛋疼？","滚蛋",{confirmButtonText:"确定",type:"error"});this.inputStatus=_()({},n,T()({},e,s))}else this.inputStatus=_()({},n,T()({},e,!1))},deleteClick:function(e){var t=this.nodeList[e];t.is_delete=0,this.$store.commit("spliceData",{name:"nodeList",obj:t,key:e})},clickClose:function(){dg.close()},save:function(){var e=u.a.submit(this),t=O()(e,3),a=t[0],i=t[1],n=t[2];if(a.datalist=g()(n),i.length){var s=[];i.forEach(function(e){s.push("<p>"+e+"</p>")});var l=s.join("");this.$alert(l,"请完善后再提交",{dangerouslyUseHTMLString:!0})}else{var o=this.$store.state,r=o.node_template_id,c=o.pageType,_=o.templateData.is_copy;c&&("update"===c?(a.node_template_id=r,a.is_copy=_):"addCopy"===c&&(a.copy_node_template_id=r,a.is_copy=1)),this.$store.dispatch("A_addOrUpdatee",{obj:a})}},_countHeight:function(){var e=this,t=0,a=setInterval(function(){if(r()(e.$refs).length){var i=e.$refs,n=i.comTableBox,s=i.bottomBox;n.clientHeight&&s.clientHeight&&(e.tableHeight=n.clientHeight-s.clientHeight,clearInterval(a))}t>100&&clearInterval(a),t++},100)},_arrIncludes:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!1,i=0;i<t.length;i++)t[i]===e&&(a=!0);return a}}},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"comTableBox",staticClass:"comTableBox"},[a("p",{staticStyle:{display:"none"}},[e._v(e._s(e.tableData))]),e._v(" "),e._l(e.tableObj,function(t,i){return i===e.tableActive&&"showView"!==e.pageType?a("el-table",{key:"table_"+i,attrs:{data:t,size:"mini",border:"",height:e.tableHeight}},[a("el-table-column",{attrs:{label:"",width:"40",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index+1)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._arrIncludes(t.row.node_code,e.arrCodeUsed)||"showView"===e.pageType?e._e():a("el-tag",{staticClass:"deleteBtn",attrs:{size:"mini",plain:""},on:{click:function(a){e.deleteClick(t.row.key)}}},[e._v("\n          删除\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点标识",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.tableObj[i][t.row.index]&&2!==t.row.node_ierarchy?a("el-checkbox-group",{attrs:{disabled:"showView"===e.pageType},model:{value:e.tableObj[i][t.row.index].badge,callback:function(a){e.$set(e.tableObj[i][t.row.index],"badge",a)},expression:"tableObj[index][scope.row.index].badge"}},[a("el-checkbox",{staticClass:"comCheckbox",attrs:{label:"is_core_node"}},[e._v("核心节点")]),e._v(" "),a("el-checkbox",{staticClass:"comCheckbox",attrs:{label:"is_audit_follow"}},[e._v("审核关注")])],1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:2===t.row.node_ierarchy?"color: #C0C4CC;":""},[e._v(e._s(t.row.node_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"node_code",label:"节点编码",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{label:"节点层级",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:2===t.row.node_ierarchy?"grey":""},[e._v(e._s(e.ierarchyObj[t.row.node_ierarchy]||""))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"提报类型",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.node_ierarchy?a("span",{staticClass:"grey"},[e._v(e._s(e.typeObj[t.row.submit_type]))]):a("div",[e.tableObj[i][t.row.index]?a("el-select",{staticClass:"comSelect",attrs:{size:"mini",disabled:"showView"===e.pageType},model:{value:e.tableObj[i][t.row.index].submit_type,callback:function(a){e.$set(e.tableObj[i][t.row.index],"submit_type",a)},expression:"tableObj[index][scope.row.index].submit_type"}},[a("el-option",{staticClass:"comSelectOptions",attrs:{label:"系统计算",value:1}}),e._v(" "),a("el-option",{staticClass:"comSelectOptions",attrs:{label:"用户提报",value:2}}),e._v(" "),a("el-option",{staticClass:"comSelectOptions",attrs:{label:"系统生成",value:3}})],1):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"系统计算公式","min-width":"400"},scopedSlots:e._u([{key:"default",fn:function(t){return["用户提报"!==e.typeObj[t.row.submit_type]?a("div",[e.tableObj[i][t.row.index]?a("el-input",{attrs:{disabled:"showView"===e.pageType,size:"mini",placeholder:0===t.row.index?"如:Math.min(Math.max(${APPQR},${PPWLDQ})-2,(${KC}-2))":"请输入计算公式"},on:{change:function(a){e.inputChange("第"+(t.row.index+1)+"行_系统计算公式",a,t.row.node_code,"main")}},model:{value:e.tableObj[i][t.row.index].sys_clac_formula,callback:function(a){e.$set(e.tableObj[i][t.row.index],"sys_clac_formula",a)},expression:"tableObj[index][scope.row.index].sys_clac_formula"}}):e._e()],1):e._e(),e._v(" "),"用户提报"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点验证区间最小值",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["系统生成"!==e.typeObj[t.row.submit_type]?a("div",[e.tableObj[i][t.row.index]?a("el-input",{attrs:{disabled:"showView"===e.pageType,size:"mini",placeholder:0===t.row.index?"如:${KSJZZ}+3":"请输入计算公式"},on:{change:function(a){e.inputChange("第"+(t.row.index+1)+"行_节点验证区间最小值",a,t.row.node_code)}},model:{value:e.tableObj[i][t.row.index].min_section_value,callback:function(a){e.$set(e.tableObj[i][t.row.index],"min_section_value",a)},expression:"tableObj[index][scope.row.index].min_section_value"}}):e._e()],1):e._e(),e._v(" "),"系统生成"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点验证区间最大值",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["系统生成"!==e.typeObj[t.row.submit_type]?a("div",[e.tableObj[i][t.row.index]?a("el-input",{attrs:{disabled:"showView"===e.pageType,size:"mini",placeholder:0===t.row.index?"如:${KSJZZ}+3":"请输入计算公式"},on:{change:function(a){e.inputChange("第"+(t.row.index+1)+"行_节点验证区间最大值",a,t.row.node_code)}},model:{value:e.tableObj[i][t.row.index].max_section_value,callback:function(a){e.$set(e.tableObj[i][t.row.index],"max_section_value",a)},expression:"tableObj[index][scope.row.index].max_section_value"}}):e._e()],1):e._e(),e._v(" "),"系统生成"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点验证说明",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["系统生成"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):a("div",[e.tableObj[i][t.row.index]?a("el-input",{attrs:{size:"mini",placeholder:"请输入验证说明",disabled:"showView"===e.pageType},model:{value:e.tableObj[i][t.row.index].verification_remark,callback:function(a){e.$set(e.tableObj[i][t.row.index],"verification_remark",a)},expression:"tableObj[index][scope.row.index].verification_remark"}}):e._e()],1)]}}])})],1):e._e()}),e._v(" "),e._l(e.tableObj,function(t,i){return i===e.tableActive&&"showView"===e.pageType?a("el-table",{key:"table_"+i,attrs:{data:t,size:"mini",border:"",height:e.tableHeight}},[a("el-table-column",{attrs:{label:"节点标识",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.tableObj[i][t.row.index].badgeText.join("，"))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:2===t.row.node_ierarchy?"color: #C0C4CC;":""},[e._v(e._s(t.row.node_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"node_code",label:"节点编码",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{label:"节点层级",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:2===t.row.node_ierarchy?"grey":""},[e._v(e._s(e.ierarchyObj[t.row.node_ierarchy]||""))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"提报类型",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.node_ierarchy?a("span",{staticClass:"grey"},[e._v(e._s(e.typeObj[t.row.submit_type]))]):a("div",[e._v("\n          "+e._s(e.typeObj[e.tableObj[i][t.row.index].submit_type])+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"系统计算公式","min-width":"400"},scopedSlots:e._u([{key:"default",fn:function(t){return["用户提报"!==e.typeObj[t.row.submit_type]?a("div",[e._v("\n          "+e._s(e.tableObj[i][t.row.index].sys_clac_formula)+"\n        ")]):e._e(),e._v(" "),"用户提报"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点验证区间最小值",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["系统生成"!==e.typeObj[t.row.submit_type]?a("div",[e._v("\n          "+e._s(e.tableObj[i][t.row.index].min_section_value)+"\n        ")]):e._e(),e._v(" "),"系统生成"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点验证区间最大值",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["系统生成"!==e.typeObj[t.row.submit_type]?a("div",[e._v("\n          "+e._s(e.tableObj[i][t.row.index].max_section_value)+"\n        ")]):e._e(),e._v(" "),"系统生成"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"节点验证说明",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["系统生成"===e.typeObj[t.row.submit_type]?a("span",[e._v("----")]):a("div",[e._v("\n          "+e._s(e.tableObj[i][t.row.index].verification_remark)+"\n        ")])]}}])})],1):e._e()}),e._v(" "),a("div",{ref:"bottomBox",staticClass:"bottomBox"},["showView"!==e.pageType?a("el-button",{staticClass:"bottomBtn",attrs:{size:"mini",type:"primary",plain:""},on:{click:e.save}},[e._v("保存")]):e._e(),e._v(" "),a("el-button",{staticClass:"bottomBtn",attrs:{size:"mini",type:"info",plain:""},on:{click:e.clickClose}},[e._v("关闭")])],1)],2)},staticRenderFns:[]};var D={components:{ComSelect:v,ComSet:y,ComTable:a("VU/8")(S,k,!1,function(e){a("HXWd"),a("wQDJ")},"data-v-32fd0071",null).exports},data:function(){return{tableStyle:{},scrollTop:0}},created:function(){this._countHeight(),dg.removeBtn("cancel"),dg.removeBtn("saveAndAdd"),dg.removeBtn("saveAndClose"),dg.removeBtn("saveNoClose")},watch:{"$store.state.isCountTableHeight":function(){this.$store.state.isCountTableHeight&&this._countHeight()}},methods:{_countHeight:function(){var e=this,t=0,a=setInterval(function(){if(r()(e.$refs).length){var i=e.$refs,n=i.page,s=i.select,l=i.set;if(n.clientHeight&&s.$el&&s.$el.clientHeight&&l.$el&&l.$el.clientHeight){var o=n.clientHeight-s.$el.clientHeight-l.$el.clientHeight-10;e.tableStyle={height:o+"px"},clearInterval(a)}}t>100&&clearInterval(a),t++},100)},pageScroll:function(e){var t=e.target.scrollTop,a=this.scrollTop;Math.abs(t-a)<300?(this.scrollTop=e.target.scrollTop,this.$refs.page.scrollTop=t):this.$refs.page.scrollTop=a}}},$={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"page",staticClass:"pageBox",on:{scroll:this.pageScroll}},[t("com-select",{ref:"select"}),this._v(" "),t("com-set",{ref:"set"}),this._v(" "),t("com-table",{style:this.tableStyle})],1)},staticRenderFns:[]};var B=a("VU/8")(D,$,!1,function(e){a("Or2J"),a("ug2D")},"data-v-4a918f95",null).exports;i.default.use(l.a);var V=new l.a({routes:[{path:"/center",component:B,name:"信息中心"},{path:"/",component:B,name:""}]}),E=a("mtWM"),z=a.n(E),A=a("mw3O"),H=a.n(A),N=a("zL8q"),I=a.n(N);z.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",z.a.interceptors.request.use(function(e){return e});var L=function(e){var t=void 0,a=e.path,i=void 0===a?"":a,n=e.path2,s=void 0===n?"":n,l=e.obj,o=void 0===l?{}:l,r=e.suc,c=void 0===r?function(e){}:r,_=e.err,d=void 0===_?function(e){}:_,p=e.method,u=void 0===p?"get":p,m=e.loading,b=void 0===m?"":m,h=o,v=i+s;if("get"===u){var f=[];for(var x in h)f.push(x+"="+h[x]);v+=f.length?v.indexOf("?")>-1?"&"+f.join("&"):"?"+f.join("&"):""}b&&(t=N.Loading.service({text:b})),z()({method:u,url:v,data:H.a.stringify(h)}).then(function(e){c(e.data.data)}).catch(function(e){d(e),b&&t.close()})},R=window.location.origin+"/nova/",P={"模板数据":"ganttTemplateShowAction.ndo?action=getGanttTemplate","业务类型":"nodeBusinessTypeShowAction.ndo?action=getBusinessType","其他下拉选项":"ganttTemplateShowAction.ndo?action=getBusinessTypeData","保存":"ganttTemplateSaveAction.ndo?action=addOrUpdatee"},M=function(e){e.path=R+P[e.name],L(e)},U={options:function(e,t){var a=[];return e.forEach(function(e){if("ywlx"===t){var i=e.type_id,n=e.type_name,s=e.p_type_id,l=void 0===s?"":s;a.push({value:i,label:n,p_type_id:l})}if("pp"===t){var o=e.custom_id,r=e.brand_name;a.push({value:o,label:r})}if("pl"===t){var c=e.dress_type_id,_=e.type_name,d=e.custom_id;a.push({value:c,label:_,custom_id:d})}if("ssxz"===t){var p=e.business_group_id,u=e.group_name;a.push({value:p,label:u})}if("ddlx"===t){var m=e.dcode,b=e.dcvalue;a.push({value:m,label:b})}}),a},tableFirst:function(e){var t=e.nodeList,a=e.tableObj,i=[],n=[];t.forEach(function(e,t){e.index=t,i.push(e),n.push(t)});var s=n.join("_");return a[s]=i,e.tableObj=_()({},a),e.tableActive=s,i},tableSecond:function(e){var t=e.tableActive,a=e.tableObj,i=e.nodeList,n=[],s=[],l={};a[t].forEach(function(e){l[e.node_id]=e});var o=0;i.forEach(function(e){if(l[e.node_id]){var t=l[e.node_id];t.index=o,n.push(t),s.push(t.key),o++}else 0!==e.is_delete&&(e.index=o,n.push(e),s.push(e.key),o++)});var r=s.join("_");return a[r]=n,e.tableObj=_()({},a),e.tableActive=r,e.addNode=!1,n},tableDelete:function(e){var t=e.tableActive,a=e.tableObj,i=e.nodeList,n=[],s=[],l=0;a[t].forEach(function(e,t){0!==i[e.key].is_delete&&(e.index=l,n.push(e),s.push(e.key),l++)});var o=s.join("_");return a[o]=n,e.tableObj=_()({},a),e.tableActive=o,n},findInArr:function(e){var t=e.text,a=e.name,i=e.returnName,n=e.arr,s={};for(var l in t)for(var o=0;o<n[l].length;o++){var r=n[l][o];if(r[a[l]]===t[l]){s[l]=r[i[l]];break}}return s}},J=U;i.default.use(m.a);var K=new m.a.Store({modules:{},state:{p_type_id:"",isCountTableHeight:!1,node_template_id:"",pageType:"",templateData:{},isRequestTemplateData:!0,ywlx:{label:"业务类型",index:"ywlx",options:[]},pp:{label:"品牌",index:"pp",options:[]},pl:{label:"品类",index:"pl",options:[]},ssxz:{label:"所属小组",index:"ssxz",options:[]},ddlx:{label:"订单类型",index:"ddlx",options:[]},templsteindex:[],addNode:!1,nodeList:[],tableObj:{asd:[]},tableActive:"asd",selectVal:{},min_lead_time:"",max_lead_time:"",template_name:""},getters:{tableData:function(e,t){var a=e.tableObj,i=e.nodeList,n=e.addNode;return i.length?1===r()(a).length?J.tableFirst(e):n?J.tableSecond(e):J.tableDelete(e):[]}},mutations:{saveData:function(e,t){var a=t.name,i=t.obj;e[a]=i},assignData:function(e,t){var a=t.name,i=t.obj,n=e[a]||{};e[a]=_()({},n,i)},spliceData:function(e,t){var a=t.name,i=t.obj,n=t.key;e[a].splice(n,1,i),e.addNode=!1},pushData:function(e,t){var a=t.name;t.obj.forEach(function(t){e[a].push(t)})}},actions:{A_getBusinessType:function(e,t){var a=e.state,i=e.dispatch,n=t.that;M({name:"业务类型",obj:{},suc:function(e){a.ywlx.options=J.options(e,"ywlx");var t=JSON.parse(localStorage.getItem("ganttTemplateAddOrUpdate"))||{},s=t.node_template_id,l=t.type;l&&(localStorage.removeItem("ganttTemplateAddOrUpdate"),i("A_getGanttTemplate",{that:n,node_template_id:s,type:l}))}})},A_getBusinessTypeData:function(e,t){var a=e.state,i=t.type_id,n=t.that;M({name:"其他下拉选项",obj:{type_id:i},suc:function(e){a.templsteindex=e.templsteindex?e.templsteindex:[];["pp","pl","ssxz","ddlx"].forEach(function(t){e[t]&&e[t].length?a[t].options=J.options(e[t],t):a[t].options=[]}),n._saveData("select"),a.pageType||setTimeout(function(){a.isCountTableHeight=!0},0);var t=a.pageType,i=a.isRequestTemplateData;if(t&&i){var s=a.templateData,l={pp:s.custom_id,pl:s.dress_type_id,ssxz:s.business_group_id,ddlx:s.order_type},o={pp:a.pp.options,pl:a.pl.options,ssxz:a.ssxz.options,ddlx:a.ddlx.options},r=J.findInArr({text:l,name:{pp:"value",pl:"value",ssxz:"value",ddlx:"value"},returnName:{pp:"label",pl:"label",ssxz:"label",ddlx:"label"},arr:o}),c=r.pp,_=void 0===c?"通用":c,d=r.pl,p=void 0===d?"通用":d,u=r.ssxz,m=void 0===u?"通用":u,b=r.ddlx,h={pp:_,pl:p,ssxz:m,ddlx:void 0===b?"通用":b};for(var v in h)n.selectChange(h[v],v),n.selectShow[v]=h[v];var f=a.templateData,x=f.min_lead_time,y=f.max_lead_time;n.min_lead_time=x,n.max_lead_time=y,a.min_lead_time=x,a.max_lead_time=y,setTimeout(function(){var e=a.templateData.template_name;n.templateName=e,a.template_name=e,a.isCountTableHeight=!0},0),a.isRequestTemplateData=!1}}})},A_addOrUpdatee:function(e,t){e.state;var a=N.Loading.service({}),i=t.obj;M({name:"保存",obj:i,suc:function(e){a.close(),dg.close()},method:"post"})},A_getGanttTemplate:function(e,t){var a=e.state,i=t.that,n=t.node_template_id,s=t.type;M({name:"模板数据",obj:{node_template_id:n},suc:function(e){a.node_template_id=n,a.pageType=s,null!==e&&(e.ganttTemplateDetail.map(function(e,t){return e.key=t,e.badge=[],e.badgeText=[],1===e.is_core_node&&(e.badge.push("is_core_node"),e.badgeText.push("核心节点")),1===e.is_audit_follow&&(e.badge.push("is_audit_follow"),e.badgeText.push("审核关注")),e}),a.templateData=e);var t={ywlx:e.node_business_type_id},l={ywlx:a.ywlx.options},o=J.findInArr({text:t,name:{ywlx:"value"},returnName:{ywlx:"label"},arr:l}).ywlx;i.selectChange(o),i.selectShow.ywlx=o,a.nodeList=e.ganttTemplateDetail}})}}}),Q=(a("tvR6"),a("hKoQ"));a.n(Q).a.polyfill(),i.default.use(I.a),new i.default({el:"#app",store:K,router:V,components:{App:s},template:"<App/>"})},Or2J:function(e,t){},c1iM:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__=__webpack_require__("woOf"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__),obj={templateName:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=e.selectShow,i=e.min_lead_time,n=e.max_lead_time,s=e.pp,l=e.pl,o=e.ssxz,r=e.ddlx,c=["【"+a.ywlx+"】"];if(a.ywlx&&t){for(var _ in a)"ywlx"!==_&&a[_]&&("pp"===_&&s.options.length&&c.push(a[_]),"pl"===_&&l.options.length&&c.push(a[_]),"ssxz"===_&&o.options.length&&c.push(a[_]),"ddlx"===_&&r.options.length&&c.push(a[_]));""!==i&&""!==n&&("-1"===i?c.push("小于"+n+"天"):"-1"===n?c.push("大于"+i+"天"):c.push(i+"至"+n+"天")),c.push("甘特表模板"),e.templateName=c.join(" ")}},windowOpen:function(e){return-1===e.indexOf("http://")},includes:function(e,t,a){var i={},n=t.match(/\$\{[\w-_:/]+\}/g)||[];if(n.length){var s=n.map(function(e){var t=e.slice(2,-1);return i[t]=!0,t}),l=a.arrCode,o=[];return s.forEach(function(e){l[e]||o.push(e)}),o.length?(a.$notify.error({title:""+e,message:o.join("、 ")+"是未知编码，请确认后再输入"}),!1):(a.codeObj=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({},a.codeObj,i),!0)}return a.$notify.error({title:""+e,message:"无节点编码，请确认后再输入"}),!1},useSelf:function(e,t,a,i){var n=t.match(/\$\{[\w-_:/]+\}/g)||[],s=i.inputCode,l={},o=!0;return n.forEach(function(e){e.slice(2,-1)===a?o=!1:l[e.slice(2,-1)]=!0}),o?(s[a]=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({},{},l),i.inputCode=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({},s),!0):(i.$notify.error({title:""+e,message:"引用了自身节点，请重新输入"}),!1)},eachOther:function(e,t,a,i){var n=t.match(/\$\{[\w-_:/]+\}/g)||[],s=i.inputCode,l=!0;return n.forEach(function(e){e.slice(2,-1)!==a&&s[e.slice(2,-1)]&&s[e.slice(2,-1)][a]&&(l=!1)}),!!l||(i.$notify.error({title:""+e,message:"有互相引用的节点，请重新输入"}),!1)},math:function(key,str,that){var strReplace=str.replace(/[0-9]+/g,function(e){return 60*parseInt(e)*60*24*1e3}).replace(/\$\{[\w-_:/]+\}/g,function(e,t){return(new Date).getTime()+60*t*60*24*1e3});try{var result=eval(strReplace);return!0}catch(e){return setTimeout(function(){that.$notify.error({title:""+key,message:"公式有误，请确认后再输入"})},0),!1}},submit:function(e){var t=[],a=e.$store.state,i=a.selectVal,n=a.min_lead_time,s=a.max_lead_time,l=a.template_name,o={node_business_type_id:"",custom_id:"",dress_type_id:"",business_group_id:"",order_type:"",min_lead_time:n,max_lead_time:s,template_name:l};if(l&&i.ywlx){var r={ywlx:"node_business_type_id",pp:"custom_id",pl:"dress_type_id",ssxz:"business_group_id",ddlx:"order_type"};for(var c in i)o[r[c]]="通用"===i[c]?"":i[c]}i.ywlx||t.push("请选择业务类型"),l||t.push("请选择填写模板名称");var _=e.tableData,d=e.inputStatus,p=e.nodeList,u=[],m=e.codeObj;for(var b in _.length?_.forEach(function(e,t){p[e.key]=e}):t.push("请添加节点后再保存"),p.forEach(function(a,i){if(a.sys_clac_formula||0===a.is_delete||2===parseInt(a.submit_type)){a.is_delete=0===a.is_delete?a.is_delete:1,a.is_core_node=0,a.is_audit_follow=0,a.badge.forEach(function(e){a[e]=1}),2===parseInt(a.submit_type)&&(a.sys_clac_formula="",d["第"+(i+1)+"行_系统计算公式"]=!0),0===a.is_delete&&(a.sys_clac_formula="",d["第"+(i+1)+"行_系统计算公式"]=!0);var n=a.sys_clac_formula,s=a.is_audit_follow,l=a.is_core_node,o=a.max_section_value,r=a.min_section_value,c=a.node_code,_=a.node_id,p=a.node_ierarchy,b=a.node_name,h=a.verification_remark,v=a.is_delete,f=a.node_template_detail_id,x={sys_clac_formula:n,is_audit_follow:s,is_core_node:l,max_section_value:o,min_section_value:r,node_code:c,node_id:_,node_ierarchy:p,node_name:b,verification_remark:h,submit_type:parseInt(a.submit_type),is_delete:v};"update"===e.$store.state.pageType&&(x.node_template_detail_id=f),!0===m[a.node_code]?x.is_quote=1:x.is_quote=0,u.push(x)}else t.push("请填写第"+(i+1)+"行_系统计算公式")}),u.length||t.push("请添加节点后再保存"),d)!1===d[b]&&t.push(b+"输入错误");return[o,t,u]}};__webpack_exports__.a=obj},"jZ2/":function(e,t){},t6hP:function(e,t){},tvR6:function(e,t){},ug2D:function(e,t){},wQDJ:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.3a0a06232de605792435.js.map